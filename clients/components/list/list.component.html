<div class="card p-6">
  <p-toast></p-toast>
  <p-confirmDialog [style]="{ width: '450px' }"></p-confirmDialog>

  <p-toolbar styleClass="mb-6">
    <ng-template pTemplate="start">
      <p-button
        label="Nouveau"
        icon="pi pi-plus"
        class="mr-2 btn-success-custom"
        (click)="openNew()"
      />
      <p-button
        label="Modifier"
        icon="pi pi-pencil"
        class="mr-2 btn-warning-custom"
        [disabled]="!hasOnlyOneSelectedClient()"
        (click)="editSelectedClient()"
      />
      <p-button
        label="Supprimer"
        icon="pi pi-trash"
        class="btn-danger-custom"
        [disabled]="!hasSelectedClients()"
        (click)="deleteSelectedClients()"
      />
    </ng-template>
  </p-toolbar>

  <p-table
    #dt
    [value]="clients()"
    [selection]="selectedClients()"
    (selectionChange)="selectedClients.set($event)"
    dataKey="CLIENT_ID"
    [rows]="10"
    [paginator]="true"
    [rowsPerPageOptions]="[5, 10, 15, 20]"
    [rowHover]="true"
    [loading]="isLoading()"
    [globalFilterFields]="['NOM', 'NOM2', 'CLIENT_CODE', 'VILLE', 'TEL', 'GSM']"
    currentPageReportTemplate="Affichage de {first} à {last} sur {totalRecords} enregistrements"
    [showCurrentPageReport]="true"
  >
    <ng-template pTemplate="caption">
      <div class="flex items-center justify-between">
        <h5 class="m-0 text-xl font-semibold">Gérer les clients</h5>
        <p-iconfield iconPosition="left">
        <p-inputicon class="pi pi-search"></p-inputicon>
        <input
          pInputText
          type="text"
          (input)="applyGlobalFilter($event)"
          placeholder="Rechercher..."
          class="w-full sm:w-auto"
        />
      </p-iconfield>
      </div>
    </ng-template>

    <ng-template pTemplate="header">
      <tr>
        <th style="width: 3rem">
          <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
        </th>
        <th pSortableColumn="CLIENT_CODE">
          Code
          <p-sortIcon field="CLIENT_CODE"></p-sortIcon>
        </th>
        <th pSortableColumn="NOM" style="min-width: 15rem">
          Nom
          <p-sortIcon field="NOM"></p-sortIcon>
        </th>
        <th pSortableColumn="NOM2" style="min-width: 15rem">
          Prénom
          <p-sortIcon field="NOM2"></p-sortIcon>
        </th>
        <th pSortableColumn="VILLE">
          Ville
          <p-sortIcon field="VILLE"></p-sortIcon>
        </th>
        <th pSortableColumn="TEL">
          Téléphone
          <p-sortIcon field="TEL"></p-sortIcon>
        </th>
        <th pSortableColumn="GSM">
          Portable
          <p-sortIcon field="GSM"></p-sortIcon>
        </th> 
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-item>
      <tr>
        <td>
          <p-tableCheckbox [value]="item"></p-tableCheckbox>
        </td>
        <td>{{ item.CLIENT_CODE }}</td>
        <td>{{ item.NOM }}</td>
        <td>{{ item.NOM2 || 'N/A' }}</td>
        <td>{{ item.VILLE || 'N/A' }}</td>
        <td>{{ item.TEL || 'N/A' }}</td>
        <td>{{ item.GSM || 'N/A' }}</td>
        
      </tr>
    </ng-template>
  </p-table>
</div>